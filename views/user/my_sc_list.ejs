<%# views/user/my_sc_list.ejs %>
<%- include('../partials/breadcrumbs', { breadcrumbs: breadcrumbs }) %>

<h1><i class="fas fa-code-branch me-2"></i>Source Code Saya</h1>
<p>Kelola semua source code yang telah Anda upload ke marketplace.</p>
<hr>

<div class="d-flex justify-content-end mb-3">
    <a href="/sc/add" class="btn btn-success"><i class="fas fa-plus-circle me-1"></i> Tambah Source Code Baru</a>
</div>

<% if (mySourceCodes && mySourceCodes.length > 0) { %>
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-light">
            <tr>
                <th>Judul</th>
                <th>Kategori</th>
                <th>Harga Beli</th>
                <th>Status</th>
                <th>Tanggal Upload</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody>
            <% mySourceCodes.forEach(sc => { %>
            <tr>
                <td><a href="/sc/<%= sc._id %>" class="fw-semibold"><%= sc.title %></a></td>
                <td><%= sc.category %></td>
                <td>
                    <% if (sc.price_buy) { %>
                        Rp <%= sc.price_buy.toLocaleString('id-ID') %>
                    <% } else if (sc.is_for_rent_only) { %>
                        <span class="badge bg-info-subtle text-info-emphasis border border-info-subtle">Hanya Sewa</span>
                    <% } else { %>
                        -
                    <% } %>
                </td>
                <td>
                    <% if (sc.status === 'approved') { %>
                        <span class="badge bg-success-subtle text-success-emphasis border border-success-subtle"><i class="fas fa-check-circle me-1"></i>Disetujui</span>
                    <% } else if (sc.status === 'pending_approval') { %>
                        <span class="badge bg-warning-subtle text-warning-emphasis border border-warning-subtle"><i class="fas fa-hourglass-half me-1"></i>Menunggu Approval</span>
                    <% } else if (sc.status === 'rejected') { %>
                        <span class="badge bg-danger-subtle text-danger-emphasis border border-danger-subtle"><i class="fas fa-times-circle me-1"></i>Ditolak</span>
                    <% } else if (sc.status === 'delisted') { %>
                         <span class="badge bg-secondary-subtle text-secondary-emphasis border border-secondary-subtle"><i class="fas fa-eye-slash me-1"></i>Delisted</span>
                    <% } else { %>
                        <span class="badge bg-light text-dark border"><%= sc.status.replace('_', ' ') %></span>
                    <% } %>
                </td>
                <td><%= new Date(sc.createdAt).toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' }) %></td>
                <td>
                    <a href="/sc/edit/<%= sc._id %>" class="btn btn-sm btn-outline-primary me-1" title="Edit Source Code">
                        <i class="fas fa-edit"></i>
                    </a>
                    <%# Tambahkan tombol lain jika perlu, misal untuk delist %>
                    <% if (sc.status === 'approved') { %>
                        <button class="btn btn-sm btn-outline-secondary" title="Delist (Fitur Belum Ada)" disabled>
                            <i class="fas fa-eye-slash"></i>
                        </button>
                    <% } %>
                </td>
            </tr>
            <% }) %>
        </tbody>
    </table>
</div>
<% } else { %>
<div class="alert alert-info d-flex align-items-center" role="alert">
    <i class="fas fa-info-circle fa-2x me-3"></i>
    <div>
        Anda belum mengupload source code apapun. <br>
        <a href="/sc/add" class="alert-link">Klik di sini untuk menambahkan source code pertama Anda!</a>
    </div>
</div>
<% } %>